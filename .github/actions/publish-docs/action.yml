# This is a basic workflow to help you get started with Actions

name: Publish Mantid Imaging docs

inputs:
  token:
    description: 'Github API Token'
    required: true

# A workflow run is made up of one or more jobs that can run sequentially or in parallel
runs:
  using: "composite"

  # Steps represent a sequence of tasks that will be executed as part of the job
  steps:
  - name: Publish docs
    shell: bash
    run: |
      conda config --set always_yes yes --set changeps1 no
      conda create -n docs_build sphinx
      source activate docs_build

      python setup.py docs_api
      sudo chmod -R 0755 docs/build
      python setup.py docs


      git config --global user.name mantid-builder
      git config --global user.email mantid-builder@hosting.com
      git config --global credential.helper store
      echo https://mantid-builder:${{ inputs.token }}@github.com > ~/.git-credentials
      python setup.py docs_publish
